# Проектирование высоконагруженных систем
## 1. Тема и целевая аудитория
**Netflix** — крупнейший в мире стриминговый сервис, предоставляющий по подписке доступ к тысячам фильмов,включая контент собственного производства.
## 2. Целевая аудитория
- География: более 190 стран по всему миру
- Аудитория: платформа насчитывает более 325 миллионов платных подписчиков по всему миру по состоянию на конец 2025 года.

- Активность и вовлеченность: 

    1) Во втором полугодии 2025 года пользователи Netflix в совокупности просмотрели 96 миллиардов часов контента
    2) Рост просмотров оригинального контента Netflix (Originals) во втором полугодии 2025 года составил 9% по сравнению с аналогичным периодом прошлого года 

## 3. Ключевой функционал
- Персонализированный каталог: подборка контента ранжированная по релевантности для конкретного пользователя
- Поиск и навигация: поиск по фильмам, сериалам, жанрам.актерам, режисеррам
- Система профилей: возможность создания нескольких профилей в рамках одной учетной записи
- Управление контентом и скачивание: добавление контента в "мой список" и возможность скачивать фильмы и сериалы для просмотра оффлайн

## Ключевые продуктовые решения
- Персонализация подбираемого контента с помощю ИИ, используются алгоритмы машинного обучения, подбираемый контент так же зависит от контекста (в какое время дня пользователь спользуется сервисом, с какого устройства)
- Собственная сеть серверов вместо публиных CDN
- Возможность создавать несколько индивидуальных профилей на один аккаунт, каждый со своими рекомендациями и настройками

## Источники
- https://ru.wikipedia.org/wiki/Netflix
- https://netflixtechblog.com/
- https://www.nielsen.com/news-center/2025/netflix-breaks-into-top-3-media-distributors-for-the-first-time-in-nielsens-june-2025-media-distributor-gauge/

# Расчет нагрузки

## Продуктовые метрики

| Показатель                     | Значение  |
|--------------------------------|-----------|
| Целевая аудитория              | 282.68 млн|
| Количество посетителей в сутки | 51.2 млн  |
| Используемые данные в час      | 3 Гб      |
| Среднее время просмотра за день| 3.2 часа  |

Источники: 
- https://tridenstechnology.com/ru/%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0-%D0%BF%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D1%87%D0%B8%D0%BA%D0%BE%D0%B2-netflix/#h-statistics-on-netflix-usage

- https://www.comparitech.com/blog/vpn-privacy/netflix-statistics-facts-figures/

| Распределение аудитории по миру   |           |
|-----------------------------------|-----------|
| Соединенные Штаты Америки         | 74.58 млн |
| Европа, Центральная Азия, Африка  | 73.73 млн |
| Латинская Америка                 | 39.61 млн |
| Азиатско-Тихоокеанский регион     | 33.72 млн |

Источник: 
- https://www.demandsage.com/netflix-subscribers/


### Рассчитаем общее количество часов просмотра в сутки:
- 51.2 млн × 3.2 ч = 163.84 млн часов/сутки
### Рассчитаем ежедневный объем видеотрафика:
- 163.84 млн ч × 3 ГБ/ч = 491.52 млн ГБ/сутки

### Оценим приблизительный вес основных страниц и элементов:

- Главная страница: 3 МБ
- Страница с поиском: 6 МБ (допустим, 6 запросов в день)
- Страница с подборками: 4 МБ
- Страница профиля: 2 МБ
- Превью фильмов: 10 МБ за штуку (загружается при наведении)

### Предположим, что каждый пользователь в день:
- Заходит на главную (1 раз) = 3 МБ
- Делает 6 поисковых запросов = 6 × 6 МБ = 36 МБ
- Смотрит подборки (1 раз) = 4 МБ
- Заходит в профиль (1 раз) = 2 МБ
- Просматривает 12 превью (наводя мышкой) = 12 × 10 МБ = 120 МБ
- Итого статики на одного пользователя в день:
3 + 36 + 4 + 2 + 120 = 165 МБ

### Общий дневной трафик статики:
51.2 млн × 165 МБ = 8 448 млн МБ/сутки

## Пиковое потребление

Для расчета пиковой нагрузки примем следующие допущения: 

- Пиковое время: 20:00–21:00 (В Европе)
- Доля пользователей в пике: 50%
- Дополнительная нагрузка от релиза: +20% 

### Итого пиковая аудитория:
51.2 млн × (0.5 + 0.2) = 51.2 млн × 0.7 = 35.84 млн пользователей

| Требуемая скорость для скачивания видео  | Мбит/с  |
|------------------------------------------|---------|
| FullHD                                   | 5-8     |
| 2K                                       | 25      |
| 4K                                       | 45      |

Для расчетов будем использовать среднюю скорость подключения в 6 Мбит/с
Общая скорость в пике:
35.84 млн × 6 Мбит/с = 215.04 млн Мбит/с

## Требуемый размер хранилища
На Netflix хранится около 36 000 часов фильмов и сериалов. Каждый час видео дублируется в среднем в 50 экземплярах для поддержки разных разрешений (FullHD, 2K, 4K), форматов аудио, частот кадров, а также включает превью и трейлеры.

С учётом исходных (FullHD ~9 ГБ/ч, 4K ~29 ГБ/ч) и всех дополнительных материалов средний объём на один час контента составляет 65 ГБ.

### Общий объём библиотеки:
36 000 ч × 65 ГБ/ч = 2 340 000 ГБ ≈ 2,34 ПБ

Данные пользователей (аккаунты, подписки, история просмотров) занимают менее 1% от объёма контента — не более 0,023 ПБ.

| Тип данных            | 	Объём (ПБ) |
|-----------------------|--------------|
|Библиотека контента	|    2,34      |
|Пользовательские данные|	< 0,023    |
|**ИТОГО**	~2,36 ПБ    |              |

## RPS
### Средний RPS:
Пиковый RPS получен исходя из пиковой аудитории 35,84 млн пользователей, каждый из которых в час пик совершает 5 запросов. Коэффициент роста от среднего к пиковому RPS составил ≈5,6.

| Тип запроса                    | Запросов в день на пользователя | Средний RPS | Пиковый RPS |
|--------------------------------|----------------------------------|-------------|-------------|
| Получение ленты рекомендаций   | 5                                | 2 963       | 16 593      |
| Поиск контента                 | 2                                | 1 185       | 6 636       |
| Запуск видео (метаданные/манифест) | 3                            | 1 778       | 9 956       |
| Лайки / оценки                 | 1                                | 593         | 3 321       |
| Управление профилем             | 1                                | 593         | 3 321       |
| Добавление в «Мой список»       | 1                                | 593         | 3 321       |
| Пауза / телеметрия              | 2                                | 1 185       | 6 636       |